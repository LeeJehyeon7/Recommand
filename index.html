<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë¦¬ì¼€ì´ì˜¨ êµì–‘ ê³¼ëª© ì¶”ì²œ ì‹œìŠ¤í…œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ë¦¬ì¼€ì´ì˜¨ ìœ í•™ìƒì„ ìœ„í•œ ë§ì¶¤ êµì–‘ ê³¼ëª© ì¶”ì²œ" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="header-section">
    <div class="header-icon">ğŸ“š</div>
    <h1>êµì–‘ ê³¼ëª© ì¶”ì²œ ì‹œìŠ¤í…œ</h1>
    <p class="subtitle">ë¦¬ì¼€ì´ì˜¨ ìœ í•™ìƒ ë§ì¶¤í˜• ê³¼ëª© ì°¾ê¸°</p>
    <span class="header-chip">ğŸ¯ ê°„ë‹¨í•œ 3ê°œ ì§ˆë¬¸ìœ¼ë¡œ ë‚˜ì—ê²Œ ë§ëŠ” ê³¼ëª© ì°¾ê¸°</span>
  </div>

  <form id="survey-form">
    <!-- ê¸°ë³¸ ì •ë³´ -->
    <fieldset>
      <legend>ğŸ“ ê¸°ë³¸ ì •ë³´</legend>
      <div class="form-row">
        <div class="form-group">
          <label for="major">ì „ê³µ</label>
          <select name="major" id="major" required>
            <option value="" disabled selected>ì „ê³µì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
            <option value="ê²Œì„ì½˜í…ì¸  ìŠ¤ì¿¨">ğŸ® ê²Œì„ì½˜í…ì¸  ìŠ¤ì¿¨</option>
            <option value="ê³µì—°ì˜ˆìˆ  ìŠ¤ì¿¨">ğŸ­ ê³µì—°ì˜ˆìˆ  ìŠ¤ì¿¨</option>
            <option value="ë§Œí™”ì½˜í…ì¸  ìŠ¤ì¿¨">ğŸ“š ë§Œí™”ì½˜í…ì¸  ìŠ¤ì¿¨</option>
            <option value="ì• ë‹ˆë©”ì´ì…˜ ìŠ¤ì¿¨">ğŸ¬ ì• ë‹ˆë©”ì´ì…˜ ìŠ¤ì¿¨</option>
            <option value="ìœµí•©ì½˜í…ì¸  ìŠ¤ì¿¨">ğŸ”„ ìœµí•©ì½˜í…ì¸  ìŠ¤ì¿¨</option>
            <option value="íŒ¨ì…˜ë·°í‹°ìŠ¤íƒ€ì¼ ìŠ¤ì¿¨">ğŸ’„ íŒ¨ì…˜ë·°í‹°ìŠ¤íƒ€ì¼ ìŠ¤ì¿¨</option>
            <option value="í‘¸ë“œ ìŠ¤ì¿¨">ğŸ´ í‘¸ë“œ ìŠ¤ì¿¨</option>
          </select>
        </div>
        <div class="form-group">
          <label for="studentId">í•™ë²ˆ</label>
          <input type="text" name="studentId" id="studentId" placeholder="ì˜ˆ: 20240001" required>
        </div>
      </div>
    </fieldset>

    <!-- ì§ˆë¬¸ 1: í•œêµ­ì–´ ìˆ˜ì¤€ -->
    <fieldset>
      <legend>ğŸŒ 1. ë‹¹ì‹ ì˜ í•œêµ­ì–´ ìˆ˜ì¤€ì€ ë¬´ì—‡ì…ë‹ˆê¹Œ?</legend>
      <div class="radio-group">
        <label class="radio-label">
          <input type="radio" name="koreanLevel" value="ì´ˆê¸‰" required>
          <span class="radio-custom">ğŸŒ± ì´ˆê¸‰</span>
        </label>
        <label class="radio-label">
          <input type="radio" name="koreanLevel" value="ì¤‘ê¸‰" checked>
          <span class="radio-custom">ğŸ“— ì¤‘ê¸‰</span>
        </label>
        <label class="radio-label">
          <input type="radio" name="koreanLevel" value="ì¤‘ê³ ê¸‰">
          <span class="radio-custom">ğŸ“™ ì¤‘ê³ ê¸‰</span>
        </label>
        <label class="radio-label">
          <input type="radio" name="koreanLevel" value="ê³ ê¸‰">
          <span class="radio-custom">ğŸ“• ê³ ê¸‰</span>
        </label>
      </div>
    </fieldset>

    <!-- ì§ˆë¬¸ 2: ì›í•˜ëŠ” ë¶„ì•¼ -->
    <fieldset>
      <legend>ğŸ¨ 2. ë‹¹ì‹ ì´ ì›í•˜ëŠ” ìˆ˜ì—…ì€ ì–´ë–¤ ë¶„ì•¼ì…ë‹ˆê¹Œ? (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</legend>
      <div class="checkbox-group">
        <label class="checkbox-label">
          <input type="checkbox" name="field" value="ì¸ê°„ê³¼ ê°€ì¹˜">
          <span class="checkbox-custom">ğŸ¤” ì¸ê°„ê³¼ ê°€ì¹˜</span>
        </label>
        <label class="checkbox-label">
          <input type="checkbox" name="field" value="ë¬¸í™”ì™€ í‘œí˜„">
          <span class="checkbox-custom">ğŸ­ ë¬¸í™”ì™€ í‘œí˜„</span>
        </label>
        <label class="checkbox-label">
          <input type="checkbox" name="field" value="ì‚¬íšŒì™€ ì„¸ìƒ">
          <span class="checkbox-custom">ğŸ’¼ ì‚¬íšŒì™€ ì„¸ìƒ</span>
        </label>
        <label class="checkbox-label">
          <input type="checkbox" name="field" value="ê³¼í•™ê³¼ ê¸°ìˆ ">
          <span class="checkbox-custom">ğŸ”¬ ê³¼í•™ê³¼ ê¸°ìˆ </span>
        </label>
        <label class="checkbox-label">
          <input type="checkbox" name="field" value="ì‚¶ê³¼ ê±´ê°•">
          <span class="checkbox-custom">ğŸ’ª ì‚¶ê³¼ ê±´ê°•</span>
        </label>
      </div>
    </fieldset>

    <!-- ì§ˆë¬¸ 3: ìƒí˜¸ì‘ìš© -->
    <fieldset>
      <legend>ğŸ‘¥ 3. ë‹¹ì‹ ì€ ìˆ˜ì—… ì¤‘ í•œêµ­í•™ìƒê³¼ ì ê·¹ì ì¸ ìƒí˜¸ì‘ìš©ì„ ì›í•©ë‹ˆê¹Œ?</legend>
      <div class="radio-group">
        <label class="radio-label">
          <input type="radio" name="interaction" value="Y" required>
          <span class="radio-custom">ğŸ‘« ë„¤</span>
        </label>
        <label class="radio-label">
          <input type="radio" name="interaction" value="N">
          <span class="radio-custom">ğŸ§˜ ì•„ë‹ˆì˜¤</span>
        </label>
        <label class="radio-label">
          <input type="radio" name="interaction" value="any" checked>
          <span class="radio-custom">ğŸ¤· ìƒê´€ì—†ìŒ</span>
        </label>
      </div>
    </fieldset>

    <button type="submit">ğŸ” ì¶”ì²œ ê³¼ëª© ë³´ê¸°</button>
  </form>

  <div id="result"></div>

  <script>
    // ========================================
    // Google Sheets ì„¤ì • (ì„ íƒì‚¬í•­)
    // ========================================
    // Google Apps Script ì›¹ ì•± URLì„ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”
    // ì„¤ì • ë°©ë²•ì€ google-apps-script.js íŒŒì¼ ì°¸ê³ 
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwDRfGaMPTl3Co91suioSpHTyLc1oBFw8Ak-2iZri2pB5I5IleDq_abG5jAqG7IFOo/exec'; // ì˜ˆ: 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec'

    // ========================================
    // ê³¼ëª© ë°ì´í„° (ì„ë² ë””ë“œ)
    // ========================================
    const COURSES = [
      { NO: "1", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ì¬ë¯¸ìˆëŠ”ê¸€ì“°ê¸°", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "N", professor: "ê¹€ìœ¤ê²½" },
      { NO: "2", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ì¼ë³¸ë¯¸ë””ì–´ì˜¤ê°ì²´í—˜", koreanLevel: "ì¤‘ê¸‰A", listening: "1", speaking: "3", reading: "2", writing: "1", materialProvided: "N", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "N", professor: "ê¹€ë¯¸ì„ " },
      { NO: "3", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ëŒ€ì¸ê´€ê³„ì‹¬ë¦¬í•™", koreanLevel: "ì¤‘ê¸‰B", listening: "2", speaking: "3", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ìµœìœ¤í¬" },
      { NO: "4", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ì¹˜ìœ ë¡œì¨ì˜ë¯¸ìˆ ", koreanLevel: "ì¤‘ê¸‰B", listening: "3", speaking: "2", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ìµœì§€ìš°" },
      { NO: "5", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ë”ë‚˜ì€ì‚¶ì„ìœ„í•œì‹¬ë¦¬í•™", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "1", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ì´ë¯¼ìˆ˜" },
      { NO: "6", category: "ì‚¶ê³¼ ê±´ê°•", name: "ëª¸ë§ˆìŒì±™ê¹€ëª…ìƒ", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "2", reading: "1", writing: "1", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ë¥˜ì§€ëª…" },
      { NO: "7", category: "ê³¼í•™ê³¼ ë¯¸ë˜", name: "ì¸ë¬¼ë¡œë³´ëŠ”ê³¼í•™ì˜ì—­ì‚¬", koreanLevel: "ì¤‘ê¸‰B", listening: "3", speaking: "2", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "N", professor: "ê¹€ê²½í™”" },
      { NO: "8", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ë¬¼ì„±ì˜ë¯¸í•™", koreanLevel: "ì¤‘ê¸‰B", listening: "3", speaking: "2", reading: "2", writing: "2", materialProvided: "N", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "N", professor: "ìœ ë¯¸" },
      { NO: "9", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ëŒ€ì¸ê´€ê³„ì‹¬ë¦¬í•™", koreanLevel: "ì¤‘ê¸‰B", listening: "2", speaking: "3", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ì†Œí˜„ìˆ™" },
      { NO: "10", category: "ì‚¶ê³¼ ê±´ê°•", name: "ì•Œë ‰ì‚°ë”í…Œí¬ë‹‰", koreanLevel: "ì¤‘ê¸‰A", listening: "3", speaking: "2", reading: "1", writing: "2", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ê¹€ëŒ€í›ˆ" },
      { NO: "11", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ë ˆí¼ëŸ°ìŠ¤ì‹œë¦¬ì¦ˆ_ë£¨ì‰°", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "1", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ìœ¤í¬ì§„" },
      { NO: "12", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ë ˆí¼ëŸ°ìŠ¤ì‹œë¦¬ì¦ˆ_ì„œì‚¬ì˜ìœ„ê¸°", koreanLevel: "ì¤‘ê³ ê¸‰", listening: "4", speaking: "2", reading: "3", writing: "2", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ìœ¤í¬ì§„" },
      { NO: "13", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ìê¸°ë°œê²¬ê³¼ì†Œí†µ", koreanLevel: "ì¤‘ê¸‰B", listening: "2", speaking: "2", reading: "3", writing: "2", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ìœ¤í¬ì§„" },
      { NO: "14", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ê³¼í•™ì‹œëŒ€,ì² í•™í•˜ê¸°", koreanLevel: "ê³ ê¸‰", listening: "4", speaking: "4", reading: "3", writing: "3", materialProvided: "N", culturalContent: "ëŒ€ë¶€ë¶„ ë‹¤ë£¸", interaction: "N", professor: "ì„œë¯¼ì •" },
      { NO: "15", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ìê¸°ë°œê²¬ê³¼ì†Œí†µ", koreanLevel: "ì¤‘ê¸‰B", listening: "2", speaking: "2", reading: "2", writing: "3", materialProvided: "Y", culturalContent: "ëŒ€ë¶€ë¶„ ë‹¤ë£¸", interaction: "N", professor: "ì„œë¯¼ì •" },
      { NO: "16", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "í˜¼ìë– ë‚˜ëŠ”ì¼ë³¸ììœ ì—¬í–‰", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "1", reading: "1", writing: "2", materialProvided: "N", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "Y", professor: "ì´ì£¼ì˜" },
      { NO: "17", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ëª¸ë§ˆìŒì±™ê¹€ëª…ìƒ", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "2", reading: "1", writing: "1", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ê°•í™”" },
      { NO: "18", category: "ì‚¶ê³¼ ê±´ê°•", name: "ì˜¤ê°ëŠë‚Œìˆ²ëª…ìƒ", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "2", reading: "1", writing: "1", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ê°•í™”" },
      { NO: "19", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "í•©ì°½", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "1", reading: "1", writing: "1", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ì œê°ˆìœ¤" },
      { NO: "20", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ë¬¸í™”ë¡œë§Œë‚˜ëŠ”ì¤‘êµ­ì–´", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "1", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ëŒ€ë¶€ë¶„ ë‹¤ë£¸", interaction: "Y", professor: "ê¹€í–¥ë¦¼" },
      { NO: "21", category: "ì‚¬íšŒì™€ ì„¸ìƒ", name: "ìš°ë¦¬ê°€ì‚¬ëŠ”ì„¸ê³„", koreanLevel: "ê³ ê¸‰", listening: "4", speaking: "4", reading: "2", writing: "3", materialProvided: "N", culturalContent: "ëŒ€ë¶€ë¶„ ë‹¤ë£¸", interaction: "N", professor: "ë°•í˜œì„±" },
      { NO: "22", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ë¬¸í•™ì†ìºë¦­í„°ë§Œë‚˜ê¸°", koreanLevel: "ì¤‘ê³ ê¸‰", listening: "4", speaking: "3", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ìµœí˜œì" },
      { NO: "23", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "CK_TED Talks", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "Y", professor: "ìœ ìš°ì—´" },
      { NO: "24", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ì°½ì‘ìë¥¼ìœ„í•œì†Œì‹œì˜¤ë“œë¼ë§ˆ", koreanLevel: "ì¤‘ê³ ê¸‰", listening: "3", speaking: "3", reading: "3", writing: "2", materialProvided: "Y", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "Y", professor: "ê°•ì£¼í˜„" },
      { NO: "25", category: "ì‚¬íšŒì™€ ì„¸ìƒ", name: "ìŠ¬ê¸°ë¡œìš´ê²½ì œìƒí™œ", koreanLevel: "ì¤‘ê³ ê¸‰", listening: "3", speaking: "3", reading: "3", writing: "2", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "N", professor: "í™ëª…í—Œ" },
      { NO: "26", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ì°½ì‘ìë¥¼ìœ„í•œì¸ë¬¸í•™", koreanLevel: "ì¤‘ê³ ê¸‰", listening: "3", speaking: "2", reading: "3", writing: "3", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "N", professor: "ê¹€ì˜" },
      { NO: "27", category: "ì‚¶ê³¼ ê±´ê°•", name: "ëª¸ë§ˆìŒì±™ê¹€ëª…ìƒ", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "2", reading: "1", writing: "1", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "N", professor: "ê¹€í˜„" },
      { NO: "28", category: "ì‚¬íšŒì™€ ì„¸ìƒ", name: "ì¬ë¯¸ìˆëŠ”ë²•ì´ì•¼ê¸°", koreanLevel: "ì¤‘ê¸‰B", listening: "3", speaking: "1", reading: "3", writing: "2", materialProvided: "Y", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "N", professor: "ì„í˜¸ê· " },
      { NO: "29", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ì°½ì‘ìë¥¼ìœ„í•œê¿ˆì‘ì—…", koreanLevel: "ì¤‘ê³ ê¸‰", listening: "4", speaking: "2", reading: "3", writing: "2", materialProvided: "Y", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "Y", professor: "ê°•ê²½í¬" },
      { NO: "30", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ë™ì–‘ìš”ê´´ëŒ€ë°±ê³¼", koreanLevel: "ì¤‘ê¸‰B", listening: "2", speaking: "1", reading: "2", writing: "1", materialProvided: "Y", culturalContent: "ëŒ€ë¶€ë¶„ ë‹¤ë£¸", interaction: "Y", professor: "ì˜¤ìœ¤í˜•" },
      { NO: "31", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ì˜ˆìˆ ,ì¸ë¬¸í•™ìœ¼ë¡œë³´ë‹¤", koreanLevel: "ì¤‘ê³ ê¸‰", listening: "3", speaking: "2", reading: "3", writing: "3", materialProvided: "N", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "N", professor: "ì˜¤ìœ¤í˜•" },
      { NO: "32", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ì¹˜ìœ ë¡œì¨ì˜ë¯¸ìˆ ", koreanLevel: "ì¤‘ê¸‰B", listening: "3", speaking: "2", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "N", professor: "ì •ì†Œì—°" },
      { NO: "33", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ì˜í™”,ë§Œì•½ì—", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "2", materialProvided: "N", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "Y", professor: "ê¹€íƒœí¬" },
      { NO: "34", category: "ì‚¬íšŒì™€ ì„¸ìƒ", name: "ë ˆí¼ëŸ°ìŠ¤ì‹œë¦¬ì¦ˆ_ìœ ë°œí•˜ë¼ë¦¬", koreanLevel: "ì¤‘ê³ ê¸‰", listening: "4", speaking: "2", reading: "3", writing: "2", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "N", professor: "ì„ë™ì§„" },
      { NO: "35", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ë ˆí¼ëŸ°ìŠ¤ì‹œë¦¬ì¦ˆ_ì…°ìµìŠ¤í”¼ì–´", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "1", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "N", professor: "ê¶Œë¯¼ì„±" },
      { NO: "36", category: "ì‚¬íšŒì™€ ì„¸ìƒ", name: "ë ˆí¼ëŸ°ìŠ¤ì‹œë¦¬ì¦ˆ_ì´ê· ì‡ ", koreanLevel: "ì¤‘ê³ ê¸‰", listening: "4", speaking: "2", reading: "3", writing: "2", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "N", professor: "ì„ë™ì§„" },
      { NO: "37", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ìƒê°ì˜ì—­ì‚¬", koreanLevel: "ê³ ê¸‰", listening: "4", speaking: "3", reading: "3", writing: "3", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "N", professor: "ì„ë™ì§„" },
      { NO: "38", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ì‹ í™”ì™€ìŠ¤í† ë¦¬í…”ë§", koreanLevel: "ì¤‘ê¸‰B", listening: "3", speaking: "2", reading: "2", writing: "2", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "N", professor: "ì„ë™ì§„" },
      { NO: "39", category: "ì‚¶ê³¼ ê±´ê°•", name: "ì‹ ì²´í™œë™ì„í†µí•œíŒ€ë¹Œë”©", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "2", reading: "1", writing: "1", materialProvided: "Y", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ìœ ì¬ìƒ" },
      { NO: "40", category: "ì‚¶ê³¼ ê±´ê°•", name: "ì‹ ì²´í™œë™ì„í†µí•œíŒ€ë¹Œë”©", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "1", reading: "1", writing: "1", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ì–‘ì¬ì›…" },
      { NO: "41", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ë ˆí¼ëŸ°ìŠ¤ì‹œë¦¬ì¦ˆ_ê·¸ëŒ€ë“¤ì–´ë–»ê²Œì‚´ê²ƒì¸ê°€", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "2", materialProvided: "N", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "Y", professor: "ì´ì£¼ì˜" },
      { NO: "42", category: "ê³¼í•™ê³¼ ë¯¸ë˜", name: "ê³¼í•™ì ì‚¬ê³ ì™€ìƒìƒë ¥", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "N", professor: "ê¹€ê²½í™”" },
      { NO: "43", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ì„¸ìƒì˜ëª¨ë“ ìŒì•…", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "2", reading: "1", writing: "1", materialProvided: "N", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "N", professor: "ë°•í˜œì„±" },
      { NO: "44", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ì˜í™”,ë§Œì•½ì—", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ëŒ€ë¶€ë¶„ ë‹¤ë£¸", interaction: "N", professor: "ê¶Œë¯¼ì„±" },
      { NO: "45", category: "ì‚¶ê³¼ ê±´ê°•", name: "ëª¸ìœ¼ë¡œë°°ìš°ëŠ”ìê¸°ê´€ë¦¬", koreanLevel: "ì´ˆê¸‰", listening: "2", speaking: "2", reading: "1", writing: "1", materialProvided: "N", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "Y", professor: "ìœ ì¬ìƒ" },
      { NO: "46", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ìºë¦­í„°ë¶„ì„ê³¼ìê¸°ì´í•´", koreanLevel: "ì¤‘ê¸‰B", listening: "3", speaking: "2", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ëŒ€ë¶€ë¶„ ë‹¤ë£¸", interaction: "Y", professor: "ê°•ì£¼í˜„" },
      { NO: "47", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ë™ì–‘ê³ ì „ì˜ìˆ²", koreanLevel: "ê³ ê¸‰", listening: "3", speaking: "3", reading: "3", writing: "3", materialProvided: "Y", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "Y", professor: "ê°•ê²½í¬" },
      { NO: "48", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ë ˆí¼ëŸ°ìŠ¤ì‹œë¦¬ì¦ˆ_í•œê°•", koreanLevel: "ì¤‘ê¸‰B", listening: "2", speaking: "2", reading: "3", writing: "2", materialProvided: "N", culturalContent: "ëŒ€ë¶€ë¶„ ë‹¤ë£¸", interaction: "Y", professor: "ìœ¤í¬ì§„" },
      { NO: "49", category: "ì¸ê°„ê³¼ ê°€ì¹˜", name: "ë ˆí¼ëŸ°ìŠ¤ì‹œë¦¬ì¦ˆ_ê·¸ë¦¬ìŠ¤ë¹„ê·¹", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "2", materialProvided: "N", culturalContent: "ì „í˜€ ë‹¤ë£¨ì§€ì•ŠìŒ", interaction: "Y", professor: "ì„œë¯¼ì •" },
      { NO: "50", category: "ë¬¸í™”ì™€ í‘œí˜„", name: "ì²˜ìŒë§Œë‚˜ëŠ”ë¬¸í™”ë‹¤ì–‘ì„±", koreanLevel: "ì¤‘ê¸‰A", listening: "2", speaking: "2", reading: "2", writing: "2", materialProvided: "Y", culturalContent: "ì¼ë¶€ ë‹¤ë£¸", interaction: "Y", professor: "ìœ¤í¬ì§„" },
      { NO: "51", category: "ì‚¬íšŒì™€ ì„¸ìƒ", name: "ì—­ì‚¬ì½˜í…ì¸ ì™€ì˜ëŒ€í™”", koreanLevel: "ê³ ê¸‰", listening: "3", speaking: "3", reading: "3", writing: "3", materialProvided: "Y", culturalContent: "ëŒ€ë¶€ë¶„ ë‹¤ë£¸", interaction: "Y", professor: "ê³½í¬ì •" }
    ];

    // ========================================
    // ì¹´í…Œê³ ë¦¬ â†’ ë¶„ì•¼ ë§¤í•‘
    // ========================================
    const CATEGORY_TO_FIELD = {
      "ì¸ê°„ê³¼ ê°€ì¹˜": "ì¸ê°„ê³¼ ê°€ì¹˜",
      "ë¬¸í™”ì™€ í‘œí˜„": "ë¬¸í™”ì™€ í‘œí˜„",
      "ì‚¬íšŒì™€ ì„¸ìƒ": "ì‚¬íšŒì™€ ì„¸ìƒ",
      "ê³¼í•™ê³¼ ë¯¸ë˜": "ê³¼í•™ê³¼ ê¸°ìˆ ",
      "ì‚¶ê³¼ ê±´ê°•": "ì‚¶ê³¼ ê±´ê°•"
    };

    // ========================================
    // í•œêµ­ì–´ ìˆ˜ì¤€ë³„ í•„í„°ë§ ë§¤í•‘
    // ========================================
    const KOREAN_LEVEL_FILTER = {
      "ì´ˆê¸‰": ["ì´ˆê¸‰", "ì¤‘ê¸‰A"],
      "ì¤‘ê¸‰": ["ì´ˆê¸‰", "ì¤‘ê¸‰A", "ì¤‘ê¸‰B"],
      "ì¤‘ê³ ê¸‰": ["ì´ˆê¸‰", "ì¤‘ê¸‰A", "ì¤‘ê¸‰B", "ì¤‘ê³ ê¸‰"],
      "ê³ ê¸‰": ["ì´ˆê¸‰", "ì¤‘ê¸‰A", "ì¤‘ê¸‰B", "ì¤‘ê³ ê¸‰", "ê³ ê¸‰"]
    };

    // ========================================
    // ì¶”ì²œ ë¡œì§
    // ========================================
    function getRecommendedCourses(answers) {
      const { koreanLevel, fields, interaction } = answers;

      // í•œêµ­ì–´ ìˆ˜ì¤€ í•„í„°ë§
      const allowedLevels = KOREAN_LEVEL_FILTER[koreanLevel];

      let filtered = COURSES.filter(course => {
        // 1. í•œêµ­ì–´ ìˆ˜ì¤€ ì²´í¬
        if (!allowedLevels.includes(course.koreanLevel)) {
          return false;
        }

        // 2. ë¶„ì•¼ ì²´í¬ (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥, ì„ íƒ ì•ˆ í–ˆìœ¼ë©´ ëª¨ë‘ í¬í•¨)
        if (fields.length > 0) {
          const courseField = CATEGORY_TO_FIELD[course.category] || course.category;
          if (!fields.includes(courseField)) {
            return false;
          }
        }

        // 3. ìƒí˜¸ì‘ìš© ì²´í¬
        if (interaction !== 'any' && course.interaction !== interaction) {
          return false;
        }

        return true;
      });

      return filtered;
    }

    // ========================================
    // ê²°ê³¼ ë Œë”ë§
    // ========================================
    function renderResult(answers, recommended) {
      const resultDiv = document.getElementById("result");

      if (recommended.length === 0) {
        resultDiv.innerHTML = `
          <h2>ğŸ” ì¶”ì²œ ê²°ê³¼</h2>
          <p>ì¡°ê±´ì— ë§ëŠ” ê³¼ëª©ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì¡°ê±´ìœ¼ë¡œ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.</p>
        `;
        return;
      }

      const fieldIcons = {
        "ì¸ê°„ê³¼ ê°€ì¹˜": "ğŸ¤”",
        "ë¬¸í™”ì™€ í‘œí˜„": "ğŸ­",
        "ì‚¬íšŒì™€ ì„¸ìƒ": "ğŸ’¼",
        "ê³¼í•™ê³¼ ê¸°ìˆ ": "ğŸ”¬",
        "ì‚¶ê³¼ ê±´ê°•": "ğŸ’ª"
      };

      const itemsHtml = recommended.map((course, index) => {
        const field = CATEGORY_TO_FIELD[course.category] || course.category;
        const fieldIcon = fieldIcons[field] || "ğŸ“š";

        return `
          <div class="course-card">
            <div class="course-header">
              <div class="course-title-section">
                <h3 class="course-name">${course.name}</h3>
                <div class="course-meta">
                  <span class="meta-item">
                    ğŸ‘¨â€ğŸ« ${course.professor}
                  </span>
                  <span class="meta-item">
                    ${fieldIcon} ${field}
                  </span>
                </div>
              </div>
            </div>

            <div class="course-details">
              <div class="detail-grid">
                <div class="detail-item">
                  <span class="detail-label">í•œêµ­ì–´ ìˆ˜ì¤€</span>
                  <span class="detail-value">
                    ${course.koreanLevel}
                    <div class="skill-levels">
                      <span class="skill-item">ğŸ‘‚ ë“£ê¸° ${course.listening}</span>
                      <span class="skill-item">ğŸ’¬ ë§í•˜ê¸° ${course.speaking}</span>
                      <span class="skill-item">ğŸ“– ì½ê¸° ${course.reading}</span>
                      <span class="skill-item">âœï¸ ì“°ê¸° ${course.writing}</span>
                    </div>
                  </span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">í•™ìƒê°„ ìƒí˜¸ì‘ìš©</span>
                  <span class="detail-value">${course.interaction === 'Y' ? 'ìˆìŒ' : 'ì—†ìŒ'}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">ìë£Œ ì‚¬ì „ì œê³µ</span>
                  <span class="detail-value">${course.materialProvided === 'Y' ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}</span>
                </div>
              </div>
            </div>
          </div>
        `;
      }).join("");

      resultDiv.innerHTML = `
        <div class="result-header">
          <h2>âœ¨ ì¶”ì²œ ê³¼ëª©</h2>
          <p class="result-summary">ì´ <strong>${recommended.length}ê°œ</strong>ì˜ ê³¼ëª©ì´ ì¶”ì²œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
        </div>
        ${itemsHtml}
      `;

      // Google Sheetsì— ìë™ ì €ì¥ (URLì´ ì„¤ì •ëœ ê²½ìš°, ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì¡°ìš©íˆ ì‹¤í–‰)
      if (GOOGLE_SCRIPT_URL) {
        saveToGoogleSheets(answers, recommended).catch(error => {
          console.error('Google Sheets ì €ì¥ ì‹¤íŒ¨:', error);
        });
      }
    }

    // ========================================
    // Google Sheetsë¡œ ë°ì´í„° ì „ì†¡
    // ========================================
    async function saveToGoogleSheets(answers, recommended) {
      if (!GOOGLE_SCRIPT_URL) {
        console.log('Google Sheets URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        return false;
      }

      try {
        // recommendedëŠ” ì§ì ‘ ê³¼ëª© ê°ì²´ ë°°ì—´ì…ë‹ˆë‹¤
        const courseNames = recommended.map(course => course.name).join(', ');

        const data = {
          major: answers.major,
          studentId: answers.studentId,
          koreanLevel: answers.koreanLevel,
          fields: answers.fields,
          interaction: answers.interaction,
          recommendedCount: recommended.length,
          recommendedCourses: courseNames
        };

        const response = await fetch(GOOGLE_SCRIPT_URL, {
          method: 'POST',
          mode: 'no-cors', // Google Apps ScriptëŠ” CORS ì œí•œì´ ìˆìŒ
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });

        console.log('âœ… Google Sheets ì €ì¥ ìš”ì²­ ì „ì†¡ë¨');
        return true;
      } catch (error) {
        console.error('âŒ Google Sheets ì €ì¥ ì‹¤íŒ¨:', error);
        return false;
      }
    }

    // ========================================
    // TXT íŒŒì¼ ë‹¤ìš´ë¡œë“œ
    // ========================================
    function downloadResultAsText(answers, recommended) {
      const timestamp = new Date().toLocaleString('ko-KR');

      let content = `===========================================\n`;
      content += `    ë¦¬ì¼€ì´ì˜¨ êµì–‘ ê³¼ëª© ì¶”ì²œ ê²°ê³¼\n`;
      content += `===========================================\n\n`;
      content += `ìƒì„± ì¼ì‹œ: ${timestamp}\n\n`;

      content += `[ê¸°ë³¸ ì •ë³´]\n`;
      content += `ì „ê³µ: ${answers.major}\n`;
      content += `í•™ë²ˆ: ${answers.studentId}\n\n`;

      content += `[ì‘ë‹µ ë‚´ìš©]\n`;
      content += `1. í•œêµ­ì–´ ìˆ˜ì¤€: ${answers.koreanLevel}\n`;
      content += `2. ì›í•˜ëŠ” ë¶„ì•¼: ${answers.fields.length > 0 ? answers.fields.join(', ') : 'ì„ íƒ ì•ˆ í•¨'}\n`;
      content += `3. ìƒí˜¸ì‘ìš©: ${answers.interaction === 'Y' ? 'ì˜ˆ' : answers.interaction === 'N' ? 'ì•„ë‹ˆì˜¤' : 'ìƒê´€ì—†ìŒ'}\n\n`;

      content += `[ì¶”ì²œ ê³¼ëª© - ì´ ${recommended.length}ê°œ]\n`;
      content += `-------------------------------------------\n\n`;

      recommended.forEach((course, index) => {
        const field = CATEGORY_TO_FIELD[course.category] || course.category;
        content += `${index + 1}. ${course.name}\n`;
        content += `   - ë¶„ì•¼: ${field}\n`;
        content += `   - êµìˆ˜: ${course.professor}\n`;
        content += `   - í•œêµ­ì–´ ìˆ˜ì¤€: ${course.koreanLevel}\n`;
        content += `   - ìƒí˜¸ì‘ìš©: ${course.interaction === 'Y' ? 'ìˆìŒ' : 'ì—†ìŒ'}\n`;
        content += `   - ìë£Œ ì‚¬ì „ì œê³µ: ${course.materialProvided === 'Y' ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}\n\n`;
      });

      content += `===========================================\n`;

      // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
      const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `êµê³¼ëª©ì¶”ì²œ_${answers.studentId}_${Date.now()}.txt`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      alert('ì¶”ì²œ ê²°ê³¼ê°€ TXT íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
    }

    // ========================================
    // í¼ ì œì¶œ ì²˜ë¦¬
    // ========================================
    function initializeSurveyForm() {
      const form = document.getElementById("survey-form");

      form.addEventListener("submit", function(e) {
        e.preventDefault();

        const major = form.major.value.trim();
        const studentId = form.studentId.value.trim();
        const koreanLevel = form.koreanLevel.value;
        const interaction = form.interaction.value;

        const fieldNodes = form.querySelectorAll('input[name="field"]:checked');
        const fields = Array.from(fieldNodes).map(n => n.value);

        const answers = {
          major,
          studentId,
          koreanLevel,
          fields,
          interaction
        };

        const recommended = getRecommendedCourses(answers);
        renderResult(answers, recommended);

        document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'start' });
      });
    }

    // ========================================
    // ì´ˆê¸°í™”
    // ========================================
    document.addEventListener('DOMContentLoaded', function() {
      initializeSurveyForm();
      console.log(`âœ… ${COURSES.length}ê°œ ê³¼ëª© ë°ì´í„° ë¡œë“œ ì™„ë£Œ`);
    });
  </script>
</body>
</html>
